@page "/Dashboard"
@using Afiliado.Components;
@using Afiliado.Components.Dto
@inject IJSRuntime JSRuntime

<PageTitle>Dashboard</PageTitle>
<NavMenu Type="@type" Avatar="@avatar" Configuracion="@Configuracion"/>

<div class="container mt-4">
    <div class="bg-dark align-items-center p-2">
        <h3 class="p-3 text-white">Affiliate url</h3>
        <p class="w-auto m-2 p-2 bg-white d-flex justify-content-between align-items-center text-white" style="--bs-bg-opacity: .5;"><span >@afiliateUrl</span>
        <button type="button" class="btn btn-dark" @onclick="CopiarEnlace">
            <i class="bi bi-copy"></i>
        </button>    
        </p>
    </div>

    <div class="@Configuracion.Color.CssClass mt-4 p-2">
        <h3 class="p-3 text-white">Configuration</h3>
         <div class="p-3 pt-0 row align-items-start">
            <div class="col">
                <label for="profileImg" class="form-label text-white">Profile Image</label>
                <input type="text" class="form-control" id="profileImg" @bind="@avatar.AvatarUrl" />
            </div>

            <div class="col">
                <label for="name" class="form-label text-white">Name</label>
                <input type="text" class="form-control" id="name" @bind="@avatar.Name" />
            </div>
        </div>

        <div class="p-3 pt-0 row align-items-start">
            <div class="col">
                <label for="afiliateUrl" class="form-label text-white">Afiliate Url</label>
                <input type="text" class="form-control" id="afiliateUrl" @bind="@afiliateUrl" />
            </div>

            <div class="col">
                <label for="logoUrl" class="form-label text-white">Logo URL</label>
                <input type="text" class="form-control" id="logoUrl" @bind="@Configuracion.Logo" />
            </div>
        </div>
        
        <div class="mb-3 p-3 pt-0">
            <label for="colorSelect" class="form-label text-white">Select Color</label>
            <select class="form-select" id="colorSelect" @onchange="OnColorChange">
                @foreach (Colors color in ColorList.GetColors())
                {
                    <option value="@color.Name">@color.Name</option>
                }
            </select>
        </div>
    </div>

    <div class="mt-3 p-2">
        <div class="row align-items-start">
            <div class="@Configuracion.Color.CssClass col p-2 m-1">
                <label for="profileImg" class="form-label text-white">Profile Image</label>
                <input type="text" class="form-control" id="profileImg" @bind="@avatar.AvatarUrl" />
            </div>

            <div class="@Configuracion.Color.CssClass col p-2 m-1">
                <label for="name" class="form-label text-white">Name</label>
                <input type="text" class="form-control" id="name" @bind="@avatar.Name" />
            </div>
        </div>
    </div>
  </div>

@code {
    public Configuracion Configuracion { get; set; } = new Configuracion();

    int type = 2;

    string afiliateUrl = "https://cirsa.com/david2023";

    async Task CopiarEnlace()
    {
        await JSRuntime.InvokeVoidAsync("navigator.clipboard.writeText", afiliateUrl);
    }

    void OnColorChange(ChangeEventArgs e)
    {
       var selectedColorName = e.Value.ToString();
       Configuracion.Color = ColorList.GetColors().FirstOrDefault(c => c.Name == selectedColorName);
    }

    Avatar avatar = new Avatar()
        {
            AvatarUrl = "./img/Afiliado.png",
            Name = "David Martinez",
            ImageStyle = "width:50px;height:50px"
        };
}